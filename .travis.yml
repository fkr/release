---
dist: xenial
language: python

cache:
  directories:
    - $HOME/.cache/pip

before_install:
  - scripts/travis.sh

env:
  global:
    - OSISM_VERSION=latest

install:
  - pip install -r requirements.txt
  - pip install -r test-requirements.txt

before_script:
  - flake8 --ignore E501 src/*.py
  - yamllint latest/*.yml

script:
  - 'if [[ "$TRAVIS_EVENT_TYPE" == "cron" || $FORCE_UPDATE_IMAGES == "true" ]]; then bash scripts/update-images.sh; fi'

notifications:
  irc:
    channels:
      - "irc.freenode.org#osism"
    template:
      - "%{result} %{repository_slug}: %{commit_subject} %{build_url}"
